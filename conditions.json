{
  "version": "1.0.0",
  "condition": {
    "conditionType": "compound",
    "operator": "and",
    "operands": [
      {
        "conditionType": "compound",
        "operator": "or",
        "operands": [
          {
            "message": ":timestamp:discordPayload",
            "signature": ":signature",
            "verifyingKey": "db55ffb861ef97174c5da1563491ae39444851930aca9111039d875ca7812c23",
            "curve": "Ed25519",
            "conditionType": "ecdsa"
          },
          {
            "message": ":timestamp:discordPayload",
            "signature": ":signature",
            "verifyingKey": "845e32f597ba70fba3586cbd0acbed78b40e01df4b940d01f7a74ee1fd7a43b8",
            "curve": "Ed25519",
            "conditionType": "ecdsa"
          },
          {
            "message": ":timestamp:discordPayload",
            "signature": ":signature",
            "verifyingKey": "d13fe84b134026fc0b26667ea3880779ad1b5dec2170561136929b479ed68800",
            "curve": "Ed25519",
            "conditionType": "ecdsa"
          }
        ]
      },
      {
        "conditionType": "sequential",
        "conditionVariables": [
          {
            "varName": "senderSalt",
            "condition": {
              "conditionType": "json",
              "data": ":discordPayload",
              "query": "$.member.user.id",
              "returnValueTest": {
                "comparator": ">",
                "value": 0
              }
            },
            "operations": [
              {
                "operation": "+=",
                "value": "|Discord|Collab.Land"
              },
              {
                "operation": "keccak"
              }
            ]
          },
          {
            "varName": "senderAA",
            "condition": {
              "conditionType": "contract",
              "contractAddress": "0x69Aa2f9fe1572F1B640E1bbc512f5c3a734fc77c",
              "chain": 84532,
              "method": "computeAddress",
              "functionAbi": {
                "name": "computeAddress",
                "type": "function",
                "inputs": [
                  {
                    "name": "_bytecodeHash",
                    "type": "bytes32",
                    "internalType": "bytes32"
                  },
                  {
                    "name": "_salt",
                    "type": "bytes32",
                    "internalType": "bytes32"
                  }
                ],
                "outputs": [
                  {
                    "name": "",
                    "type": "address",
                    "internalType": "address"
                  }
                ],
                "stateMutability": "view"
              },
              "parameters": [
                "0x210ffc0da7f274285c4d6116aaef8420ecb9054faced33862197d6b951cb32f5",
                ":senderSalt"
              ],
              "returnValueTest": {
                "comparator": "!=",
                "value": "0x0000000000000000000000000000000000000000"
              }
            }
          },
          {
            "varName": "validateSender",
            "condition": {
              "signingObjectContextVar": ":signingConditionObject",
              "attributeName": "sender",
              "conditionType": "signing-attribute",
              "returnValueTest": {
                "comparator": "==",
                "value": ":senderAA"
              }
            }
          },
          {
            "varName": "amountDiscord",
            "condition": {
              "conditionType": "json",
              "data": ":discordPayload",
              "query": "$.data.options[0].options[?(@.name == \"amount\")].value",
              "returnValueTest": {
                "comparator": ">",
                "value": 0,
                "operations": [
                  {
                    "operation": "float"
                  }
                ]
              }
            },
            "operations": [
              {
                "operation": "ethToWei"
              }
            ]
          },
          {
            "varName": "recipientSalt",
            "condition": {
              "conditionType": "json",
              "data": ":discordPayload",
              "query": "$.data.options[0].options[?(@.name == \"receiver\")].value",
              "returnValueTest": {
                "comparator": ">",
                "value": 0
              }
            },
            "operations": [
              {
                "operation": "+=",
                "value": "|Discord|Collab.Land"
              },
              {
                "operation": "keccak"
              }
            ]
          },
          {
            "varName": "recipientAA",
            "condition": {
              "conditionType": "contract",
              "contractAddress": "0x69Aa2f9fe1572F1B640E1bbc512f5c3a734fc77c",
              "chain": 84532,
              "method": "computeAddress",
              "functionAbi": {
                "name": "computeAddress",
                "type": "function",
                "inputs": [
                  {
                    "name": "_bytecodeHash",
                    "type": "bytes32",
                    "internalType": "bytes32"
                  },
                  {
                    "name": "_salt",
                    "type": "bytes32",
                    "internalType": "bytes32"
                  }
                ],
                "outputs": [
                  {
                    "name": "",
                    "type": "address",
                    "internalType": "address"
                  }
                ],
                "stateMutability": "view"
              },
              "parameters": [
                "0x210ffc0da7f274285c4d6116aaef8420ecb9054faced33862197d6b951cb32f5",
                ":recipientSalt"
              ],
              "returnValueTest": {
                "comparator": "!=",
                "value": "0x0000000000000000000000000000000000000000"
              }
            }
          },
          {
            "varName": "netTipAmount",
            "condition": {
              "conditionType": "json",
              "data": ":discordPayload",
              "query": "$.data.options[0].options[?(@.name == \"amount\")].value",
              "returnValueTest": {
                "comparator": ">",
                "value": 0,
                "operations": [
                  {
                    "operation": "float"
                  }
                ]
              }
            },
            "operations": [
              {
                "operation": "ethToWei"
              },
              {
                "operation": "*=",
                "value": 99
              },
              {
                "operation": "/=",
                "value": 100
              }
            ]
          },
          {
            "varName": "feeAmount",
            "condition": {
              "conditionType": "json",
              "data": ":discordPayload",
              "query": "$.data.options[0].options[?(@.name == \"amount\")].value",
              "returnValueTest": {
                "comparator": ">",
                "value": 0,
                "operations": [
                  {
                    "operation": "float"
                  }
                ]
              }
            },
            "operations": [
              {
                "operation": "ethToWei"
              },
              {
                "operation": "*=",
                "value": 1
              },
              {
                "operation": "/=",
                "value": 100
              }
            ]
          },
          {
            "varName": "validateCalldata",
            "condition": {
              "signingObjectContextVar": ":signingConditionObject",
              "attributeName": "call_data",
              "conditionType": "signing-abi-attribute",
              "abiValidation": {
                "allowedAbiCalls": {
                  "executeBatch(address[],uint256[],bytes[])": [
                    {
                      "_comment": "Validate targets array length = 2",
                      "parameterIndex": 0,
                      "returnValueTest": {
                        "comparator": "==",
                        "value": 2,
                        "operations": [
                          {
                            "operation": "arrayLength"
                          }
                        ]
                      }
                    },
                    {
                      "_comment": "Validate call 0 target = recipientAA",
                      "parameterIndex": 0,
                      "arrayIndex": 0,
                      "returnValueTest": {
                        "comparator": "==",
                        "value": ":recipientAA"
                      }
                    },
                    {
                      "_comment": "Validate call 1 target = FEE_RECIPIENT",
                      "parameterIndex": 0,
                      "arrayIndex": 1,
                      "returnValueTest": {
                        "comparator": "==",
                        "value": "0x3B42d26E19FF860bC4dEbB920DD8caA53F93c600"
                      }
                    },
                    {
                      "_comment": "Validate call 0 value = netTipAmount (99%)",
                      "parameterIndex": 1,
                      "arrayIndex": 0,
                      "returnValueTest": {
                        "comparator": "==",
                        "value": ":netTipAmount"
                      }
                    },
                    {
                      "_comment": "Validate call 1 value = feeAmount (1%)",
                      "parameterIndex": 1,
                      "arrayIndex": 1,
                      "returnValueTest": {
                        "comparator": "==",
                        "value": ":feeAmount"
                      }
                    }
                  ]
                }
              }
            }
          }
        ]
      }
    ]
  }
}
